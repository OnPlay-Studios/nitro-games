<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  const firebaseConfig = { /* tvoje údaje */ };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const SUPER_ADMIN = "kertik_creative@outlook.sk";

  // Kontrola loginu
  onAuthStateChanged(auth, (user) => {
    if (!user) {
      window.location.href = "login.html";
    } else {
      if (user.email !== SUPER_ADMIN) {
        alert("Nemáš prístup do admin panelu!");
        window.location.href = "index.html";
      }
      document.getElementById("user").textContent = user.email;
    }
  });

  window.logout = function() {
    signOut(auth).then(() => {
      window.location.href = "login.html";
    });
  }

  window.addGame = async function() {
    const title = document.getElementById("title").value;
    const description = document.getElementById("description").value;
    const emoji = document.getElementById("emoji").value;
    const iframe = document.getElementById("iframe").value;

    await addDoc(collection(db, "games"), { title, description, emoji, iframe });
    alert("Hra pridaná ✅");
  }

  // len superadmin môže pridávať adminov
  window.addAdmin = async function() {
    const email = prompt("Zadaj email nového admina:");
    if (!email) return;
    if (auth.currentUser.email !== SUPER_ADMIN) {
      alert("Nemáš oprávnenie!");
      return;
    }
    await addDoc(collection(db, "admins"), { email });
    alert("Admin pridaný ✅");
  }
</script>
